<!DOCTYPE html>
<html lang="en">
<head>
    <title>{% block titre %}E-contact | Budgétisation - Gestion de contenu{% endblock %}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="icon" type="image/x-icon" href="{{ asset('Logo-econtact-2.png') }}" />
    <link rel="stylesheet" href="{{ asset('css/style-budgetisation-affichage.css') }}" />
</head>
<style>
    .loaders {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        background: url(../../web/ajax-loaderd.gif) center center no-repeat rgba(57, 66, 100, 0.6);
        z-index: 500;
    }
    .results{

        height: 36px;
        width: 200px;
        border: 1px solid #cccccc;
        border-radius: 4px;
        padding: 18px 11px;
        font-size: 18px;
    }
</style>

<body>

<form id="jsForm" class="form-group" action="" method="GET">
    <div class="icon-retour">
        <a style="color: #2eb2ff;" href="http://localhost/e-contact05/web/app_dev.php#fond-8{#{{ path('fos_user_profile_show') }}#}">< Retour  ( chemins des onglets parcourus )</a>
    </div>

    <section  id="fond-1" align=center>

        <div class="container">

            <div class="row">

                <div class="col-md-12 col-sm-12 col-xs-12" align=center>
                    <div class="titre-1">
                        <p>Budgétisation</p>
                    </div>
                    <div class="titre-2">
                        <p class="acroche">Engagez la relation avec vos clients potentiels avec la diffusion
                            <br>
                            d'un <span style="color: #ffdb2e"><strong>contenu pertinent et riche</strong></span>
                        </p>
                    </div>
                </div>

            </div>

        </div>

    </section>



    <section  id="fond-2">

        <div class="container">

            <div class="row">

                <div class="col-md-12 col-sm-12 col-xs-12">

                    {#<div class="btn-1">
                        <img class="icone" src="https://image.noelshack.com/fichiers/2018/08/5/1519379743-icona-2.png">
                        Affichage
                    </div>#}
                    <div class="form-inline" align="center" style="width: 1356px">
                        <div class="form-group ">
                            <div class="btn-1" style="margin-left: -200px" >
                                <a href="{{ path('referencement') }}" id="ajax_test_referencement_ther" style="color: black" >
                                    <span class="glyphicon glyphicon-triangle-left "></span> <img class="icone" src="https://image.noelshack.com/fichiers/2018/08/5/1519379743-icone-3.png" alt="icone-3">
                                    Référencement
                                </a>
                            </div>
                        </div>

                        <div class="form-group ">
                            <div class="btn-1" style="width: 330px!important;">

                                <a href="{{ path('budget_gestion_contenu') }}" id="ajax_test_referencement_ther" style="width: 319px!important;color: black">
                                    <span class="glyphicon glyphicon-triangle-left"></span><img class="icone" src="https://image.noelshack.com/fichiers/2018/08/5/1519379743-icona-2.png" alt="icone-3">
                                    Gestion de Contenu
                                </a>
                            </div>
                        </div>

                        <div class="form-group ">
                            <div class="btn-1" >

                                <a href="{{ path('budget_affichage') }}" id="ajax_test_referencement_fort"  style="color: black">
                                    <span class="glyphicon glyphicon-triangle-left"></span><img class="icone" src="https://image.noelshack.com/fichiers/2018/08/5/1519379743-icone-1.png" alt="icone-3" alt="icone-3">
                                    Affichage
                                </a>

                            </div>
                        </div>
                       <div class="form-group ">
                            <div class="btn-1" style="background-color: black;">

                                <a href="{{ path('profession_liberale') }}" id="ajax_test_referencement_fort"  style="color: white">
                                    <img class="icone" src="https://image.noelshack.com/fichiers/2018/24/3/1528884879-imageedit-48-3908522270.gif" alt="icone-3" alt="icone-3">
                                    Professsion libérale   {#<span class="glyphicon glyphicon-triangle-right"></span>#}
                                </a>

                            </div>
                        </div>

                    </div>


                    <div class="produits">

                        <form class="form-inline">
                            <div>

                                <button type="button" class="btn btn-2" data-toggle="collapse" data-target="#demo-1">
                                    <span class="glyphicon glyphicon-zoom-in"></span>&nbsp; &nbsp;Profession libérale &nbsp;   <span class="glyphicon glyphicon-triangle-right glyphicon-triangle-"></span>
                                </button>

                                <div id="demo-1" class="collapse">
                                    <div class="form-inline villes" >
                                        <button type="button" class="btn" data-toggle="collapse" data-target="#demo-1-1">
                                            Ville de départ &nbsp;   <span class="glyphicon glyphicon-triangle-bottom"></span>
                                        </button>
                                        <div id="demo-1-1" class="collapse bouton-2" style="overflow-y:scroll;">
                                            <div class="form-inline" >
                                                <label class="checkbox-inline" >
                                                    <input id="select" class="checkbox_villes profession_ville" type="checkbox" name="villes" {% if profession['villes']=='91010' %}checked {% endif %} value="91010">&nbsp; &nbsp;Casablanca
                                                </label><br>
                                                <label class="checkbox-inline">
                                                    <input id="select" class="checkbox_villes profession_ville" type="checkbox" name="villes" {% if profession['villes']=='101010' %}checked {% endif %}  value="101010">&nbsp; &nbsp;Rabat
                                                </label><br>
                                                <label class="checkbox-inline">
                                                    <input id="select" class="checkbox_villes profession_ville" type="checkbox" name="villes" {% if profession['villes']=='141010' %}checked {% endif %}  value="141010">&nbsp; &nbsp;Fès
                                                </label><br>
                                                <label class="checkbox-inline">
                                                    <input id="select" class="checkbox_villes profession_ville" type="checkbox" name="villes" {% if profession['villes']=='41110' %}checked {% endif %}  value="41110">&nbsp; &nbsp;Agadir
                                                </label><br>
                                                <label class="checkbox-inline">
                                                    <input id="select" class="checkbox_villes profession_ville" type="checkbox" name="villes" {% if profession['villes']=='163010' %}checked {% endif %}  value="163010">&nbsp; &nbsp;Tanger
                                                </label><br>
                                                <label class="checkbox-inline">
                                                    <input id="select" class="checkbox_villes profession_ville" type="checkbox" name="villes" {% if profession['villes']=='71010' %}checked {% endif %}  value="71010">&nbsp; &nbsp;Marrakech
                                                </label><br>

                                                {% for ville in villes %}
                                                    <label class="checkbox-inline">
                                                        <input id="select" class="checkbox_villes profession_ville" {% if profession['villes']  %} {% if ville.codeville==profession['villes']  %} checked {% endif %}{% endif %} type="checkbox" name="villes" value="{{ ville.codeville }}"/>&nbsp; &nbsp;{{ ville.libelle }}
                                                    </label>
                                                {% endfor %}

                                            </div>
                                        </div>
                                        <div class="form-inline region">
                                            <label class="checkbox-inline"  style="width: 181px;">
                                                <input class="checkbox_profession profession" name="profession" {% if profession['profession']=='3000' %}checked {% endif %} type="checkbox" value="3000">Profession libérale
                                            </label>
                                            <label class="checkbox-inline" style="display: none" >
                                                <input type="text" id="prix" name="prix" {% if profession['prix'] %} value="{{ profession['prix'] }}" {% else %}  value="3000" {% endif %} readonly  >
                                            </label>
                                        </div>

                                    </div>
                                </div>

                            </div>

                        </form>

                    </div>

                </div>

            </div>

        </div>

    </section>

</form>
</div>
</body>
<br><br><br><br><br><br><br>

<div class="row">
    <section  id="fond-4">

        <div class="container">

            <div class="row">

                <div class="col-md-12 col-sm-12 col-xs-12" >
                    <div class="form-group pull-left">
                        <div class="form-group">
                            <button id="ajax_test_ref" class="btn black" onclick="showhide_r() ">
                                <span style="color: #ffdb2e;">Budget estimé</span>
                                <br>Référencement
                            </button>
                            <div id="ref" style="display: none">
                                <input class="results" type="text" name="total" id="totalref"   readonly/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group pull-left">
                        <div class="form-group">
                            <button id="ajax_test_cont" class="btn black" onclick="showhide_c()">
                                <span style="color: #ffdb2e;">Budget estimé</span>
                                <br>Gestion de contenu
                            </button>
                            <div id="cat" style="display: none">
                                <input class="results" type="text" name="total" id="totalcat"  readonly/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group pull-left">
                        <div class="form-group">
                            <button id="ajax_test_referencement" class="btn black" onclick="showhide_a()">
                                <span style="color: #ffdb2e;">Budget estimé</span>
                                <br>Affichage
                            </button>
                            <div id="aff" style="display: none">
                                <input class="results" type="text" name="total" id="totalaff" value="0"  readonly/>
                            </div>
                        </div>
                    </div>

                    <div class="form-group pull-left">
                        <div class="form-group">
                            <button id="ajax_test_referencement" class="btn black" onclick="showhide_p()">
                                <span style="color: #ffdb2e;">Budget estimé</span>
                                <br>Profession libérale
                            </button>
                            <div id="prof" style="display: none">
                                <input class="results" type="text" name="total" id="totalporf" value="0"  readonly/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group pull-right">
                        <div class="form-inline">
                            <div class="form-group">
                                <button id="ajax_test_referencement_refss" class="btn black" onclick="showhide_global()">
                                    <span style="color: #ffdb2e;">Budget Global <br >estimé </span>

                                </button>
                                <div id="global" style="display: none">
                                    <input class="results" type="text" name="total" id="totalglobal" value="0"  readonly/>
                                </div>
                            </div>

                            <div class="form-inline" >
                                <div class="form-group ">
                                    <div class="btn black" style="background-color:#fe5c5b;padding: 18px 0 0 0!important;">

                                        <a href="{{ path('facture_sec') }}" id="ajax_test_referencement_fort" target="_blank" style="color: white;font-weight: bold;font-size: 22px">

                                            Devis
                                        </a>

                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>





                </div>
            </div>
            {# <div class="row">

                 <a href="{{ path('facture_sec') }}" class="btn btn-info" target="_blank">Votre Facture</a>
             </div>#}
        </div>



    </section>
</div>
<a href="#" role="button" class="btn btn-info pull-left" style="display: none;" id="ajax_test_referencement_sec">
    <span class="glyphicon glyphicon-triangle-left fleche-petit"></span> <img class="icone" src="https://image.noelshack.com/fichiers/2018/08/5/1519379743-icone-3.png" alt="icone-3">
    TEST
</a>
<body>

</html>




{% if is_granted('IS_AUTHENTICATED_FULLY') %}
    {% include 'UtilisateursBundle:Default:modulesUsed/utilisateursConnecte.html.twig' %}
{% else %}
    {% include 'UtilisateursBundle:Default:modulesUsed/utilisateurs.html.twig' %}
{% endif %}
{% render(controller('EcommerceBundle:Panier:menu')) %}


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="http://code.jquery.com/jquery.js"></script>



<script>

    $('#ajax_test_referencement_sec').on('click', function (event) {

        event.preventDefault();

        bar();
    });

    function ref()
    {
        $('.loaders').css('display','');
        var fayssal=  $("#total").val( );
        form =$('#jsForm ');
        var data_send = {'nbr': fayssal};
        $.ajax({

            url: '{{ path('referencement_commande_devis_somme') }}',
            type: 'POST',
            data: data_send,
            statusCode: {
                //traitement en cas de succès
                200: function (response) {
                    var successMessage = response;
                    var tref= successMessage.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
                    $("#totalref").val(tref);


                    /*  $('#prestation').children("option").remove();*/
                    //on vide les champs formulaires ou on le supprime ou ...
                    //on retire le loader...

                    $('.loaders').css('display','none');

//                    window.location.href = "http://localhost/ecommerce/web/app_dev.php/devis_affichage";
                },
                //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                412: function (response) {
                    var errorsForm = response.responseJSON.formErrors;
                    //on affiche les erreurs...
                    alert('error');

                }
            }
        });
    }

    $('#ajax_test_ref').on('click', function (event) {

        event.preventDefault();
        ref();



    });
    function cont()
    {

        $('.loaders').css('display','');
        var fayssal=  $("#total").val( );
        form =$('#jsForm ');
        var data_send = {'nbr': fayssal};
        $.ajax({
            url: '{{ path('referencement_commande_devis_somme_cont') }}',
            type: 'POST',
            data: data_send,
            statusCode: {
                //traitement en cas de succès
                200: function (response) {
                    var successMessage = response;
                    console.log(successMessage);
                    var tcat= successMessage.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
                    $("#totalcat").val(tcat);
                    /*  $('#prestation').children("option").remove();*/
                    //on vide les champs formulaires ou on le supprime ou ...
                    //on retire le loader...

                    $('.loaders').css('display','none');

//                    window.location.href = "http://localhost/ecommerce/web/app_dev.php/devis_affichage";
                },
                //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                412: function (response) {
                    var errorsForm = response.responseJSON.formErrors;
                    //on affiche les erreurs...
                    alert('error');

                }
            }
        });
    }

    $('#ajax_test_cont').on('click', function (event) {

        event.preventDefault();

        cont();


    });


    function aff()
    {
        $('.loaders').css('display','');
        var fayssal=  $("#total").val( );
        form =$('#jsForm ');
        var data_send = {'nbr': fayssal};
        $.ajax({
            url: '{{ path('referencement_commande_devis_somme_aff') }}',
            type: 'POST',
            data: data_send,
            statusCode: {
                //traitement en cas de succès
                200: function (response) {
                    var successMessage = response;
                    console.log(successMessage);
                    var taff= successMessage.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
                    console.log("testt",taff);
                    $("#totalaff").val(taff);


                    /*  $('#prestation').children("option").remove();*/
                    //on vide les champs formulaires ou on le supprime ou ...
                    //on retire le loader...

                    $('.loaders').css('display','none');

//                    window.location.href = "http://localhost/ecommerce/web/app_dev.php/devis_affichage";
                },
                //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                412: function (response) {
                    var errorsForm = response.responseJSON.formErrors;
                    //on affiche les erreurs...
                    alert('error');

                }
            }
        });
    }

    $('#ajax_test_referencement').on('click', function (event) {

        event.preventDefault();


        aff();



    });

    function prof()
    {

        $('.loaders').css('display','');
        var fayssal1=  $("#prix").val( );
        var fayssal= fayssal1/*.replace(/[^0-9\.]/g, '')*/;
        console.log("bonjour",fayssal1);
        form =$('#jsForm ');
        var data_send = {'nbr': fayssal1};
        $.ajax({
            url: '{{ path('referencement_commande_devis_prof') }}',
            type: 'POST',
            data: data_send,
            statusCode: {
                //traitement en cas de succès
                200: function (response){
                    var successMessage = response;


                    console.log(successMessage);
                    /*  $('#prestation').children("option").remove();*/
                    //on vide les champs formulaires ou on le supprime ou ...
                    //on retire le loader...

                    $('.loaders').css('display','none');

//                    window.location.href = "http://localhost/ecommerce/web/app_dev.php/devis_affichage";
                },
                //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                412: function (response) {
                    var errorsForm = response.responseJSON.formErrors;
                    //on affiche les erreurs...
                    alert('error');

                }
            }
        });
    }

    $('#ajax_test_profession').on('click', function (event) {

        event.preventDefault();


        prof();



    });
    /*----------------------------------*/
    function showhide_r()
    {
        var div = document.getElementById("ref");
        if (div.style.display == "none") {
            div.style.display = "block";
        }
        else {
            div.style.display = "none";
        }
    }

    function showhide_c()
    {
        var div = document.getElementById("cat");
        if (div.style.display == "none") {
            div.style.display = "block";
        }
        else {
            div.style.display = "none";
        }
    }
    function showhide_a()
    {
        var div = document.getElementById("aff");
        if (div.style.display == "none")
        {
            div.style.display = "block";
        }
        else
        {
            div.style.display = "none";
        }
       /* bar();*/
    }
    function showhide_p()
    {
        var div = document.getElementById("prof");
        if (div.style.display == "none")
        {
            div.style.display = "block";
        }
        else
        {
            div.style.display = "none";
        }
    }

    function showhide_global()
    {

        ref();
        cont();
        aff()



        var vat = +$("#totalref").val().replace(/[^0-9\.]/g, '') || 0;
        var vard = +$("#totalcat").val().replace(/[^0-9\.]/g, '') || 0;
        var final = +$("#totalaff").val().replace(/[^0-9\.]/g, '') || 0;
        var profession = +$("#totalporf").val().replace(/[^0-9\.]/g, '') || 0;

        $bar=vat+vard+final;
        var tg= (vat+vard+final+profession).toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        $("#totalglobal").val(tg);

        console.log($bar);

        var div = document.getElementById("global");
        if (div.style.display == "none") {
            div.style.display = "block";
        }
        else {
            div.style.display = "none";
        }
       /* bar();*/
    }

    /*----------------------------------*/

    var selectfct = function () {
        if($(".profession_ville").is(":checked")){
            $('.profession').prop('disabled', false);
        }else{
            $('.profession').prop('disabled', 'disabled');
        }
    };
    $(selectfct);
    $(".profession_ville").click(selectfct);
</script>

<script type="text/javascript">
    $(document).ready(function() {

        function cal2() {
            var totalref = +$("#totalref").val().replace(/[^0-9\.]/g, '') || 0;
            var totalcat = +$("#totalcat").val().replace(/[^0-9\.]/g, '') || 0;
            var totalaff = +$("#totalaff").val().replace(/[^0-9\.]/g, '') || 0;
            var totalporf = +$("#totalporf").val().replace(/[^0-9\.]/g, '') || 0;
            var totalglobal = parseInt(totalref) + parseInt(totalcat) + parseInt(totalaff)+ parseInt(totalporf);
            var tg = totalglobal.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
            $("#totalglobal").val(tg);
        }
    });


</script>



<script>
    $(document).ready(function() {

        tot();
        function tot(){

            var total = 0;
            var t;
            $(".checkbox_profession:checked").each(function() {
                total += parseInt($(this).val());
                t= total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
            });
            if (t == 0) {
                $('#totalporf').val(0);
            } else {
                $('#totalporf').val(t);
            }
        }
        $(".checkbox_profession").change(function(event) {
            var total = 0;
            var t;
            $(".checkbox_profession:checked").each(function() {
                total += parseInt($(this).val());
                t= total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");

            });
            if (t == 0) {
                $('#totalporf').val(0);
            } else {
                $('#totalporf').val(t);
            }
         /*   kam();*/
        });
    });



    $(document).on('change', '.checkbox_villes,.checkbox_profession', function () {

        $('.loaders').css('display','');
        var villes = $('input[name=villes]:checked').val();
        var profession = $('input[name=profession]:checked').val();
        var prix = $('input[name=prix]').val();
        var data_send    = {'villes': villes,'profession':profession,'prix':prix};
        $.ajax({
            url: '{{ path('referencement_commande_profession') }}',
            type: 'POST',
            data: data_send,
            statusCode: {
                //traitement en cas de succès
                200: function (response) {
                    var successMessage = response;
                    console.log(successMessage);
                    prof();
                    /*  $('#prestation').children("option").remove();*/
                    //on vide les champs formulaires ou on le supprime ou ...
                    //on retire le loader...
//                    window.location.href = "http://localhost/ecommerce/web/app_dev.php/devis_affichage";
                    $('.loaders').css('display','none');

                },
                //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                412: function (response) {
                    var errorsForm = response.responseJSON.formErrors;
                    //on affiche les erreurs...
                    alert('error');

                }
            }
        });


    });

    $('.checkbox_villes').on('change', function() {
        $('.checkbox_villes').not(this).prop('checked', false);
    });

</script>






